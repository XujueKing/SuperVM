直接把“接入即服务”的去中心化聊天落成了一个最小可运行 PoC，并补了一份完整实现指南，方便团队按此扩展到生产。

## 做了什么?

- 新增完整指南
  - decentralized-chat-on-four-layer-network.md
  - 覆盖身份与加密（X3DH/Double Ratchet）、神经网络寻址与多级中继、可靠性（ACK/重传/去重）、存储/备份到 L1 的两种模式（全量/锚定）、合规策略（白名单传输/NAT 回退/地理围栏）、SDK 合同草案与 6 周 MVP 路线图
  - 文末加了 Windows PowerShell 运行指令的 Try it

- 增加可运行 PoC
  - src/node-core/examples/chat_poc.rs：基于 libp2p 的 gossipsub + mDNS，零中心服务器，局域网自动发现，双端直接发消息
  - 为 node-core 增加最小 libp2p 依赖集（tcp/dns/noise/yamux/gossipsub/mdns/identify/ping）

- 索引对接
  - INDEX.md 增加“去中心化聊天（四层神经网络）”入口，便于发现

## 如何快速试用（Windows PowerShell）

- 同网两端各开一个终端，分别运行：

```powershell
cargo run -p node-core --example chat_poc

```

- 在任意一侧输入消息回车，另一侧应能收到。该 PoC 使用 mDNS 自动发现 + gossipsub 主题广播，演示“接入即服务”的最小链路；跨网再加上公网可达地址或合规中继即可。

提示：

- 首次构建会拉取依赖，时间较久；我已发起类型检查，依赖解析正常进行。如遇构建错误，我会跟进修复。

## 你的关键需求对照

- 无中心化聊天服务器：已验证。PoC 端到端直连，失败可按指南升级至边缘（L3）合规中继，不承载业务数据，不构成中心服务器。

- 接入即服务（AaaS）：已落实。客户端直接接入四层网络（L4→L3→L2→L1），通过神经网络寻址拿到连接能力。

- 聊天记录可选备份到 L1：已设计两种模式
  - A 全量上 L1（成本高、适合强合规留痕）
  - B 外部存储（如 IPFS/L2）+ L1 哈希锚定（推荐，显著降费）
  - 均端到端加密，含密钥轮换/撤回与最小元数据设计

## 后续可加的两项增量

- 跨网/公网连通增强：加入 DCUtR/QUIC 与合规中继拨号样例，PoC 覆盖 WAN 场景

- SDK 初版：把指南中的 SDK 合同草案落成 crate（init/connect/send/backup/restore）+ 最小演示 App

质量门槛快照

- Build: 依赖解析成功，类型检查已发起（预计 PASS；如有编译问题我会继续修复）

- Lint/Typecheck: 进行中

- Tests: 本次属新增示例和文档，暂无测试变更

需要的话，我可以继续把跨网连通（QUIC/DCUtR + 合规中继拨号）也补进 PoC，或直接开一个 chat-sdk crate 做成可嵌入的 SDK。

--------------------------------------------------------------------------------------------


# 去中心化聊天的实现示例（四层神经网络）

> 本文为中文说明，英文文件名版本请见：`docs/decentralized-chat-on-four-layer-network.md`

---

## 快速体验（PowerShell）

同一局域网两端各执行：

```powershell
cargo run -p node-core --example chat_poc

```

跨网（已知对端地址）：

```powershell

# 在 A 侧启动，注意输出的 Listening on 地址

cargo run -p node-core --example chat_poc

# 在 B 侧使用 --dial 拨号

cargo run -p node-core --example chat_poc -- --dial /ip4/192.168.1.20/tcp/40045

```

- 无需中心化聊天服务器，mDNS 自动发现或手动拨号直连；

- 消息使用 gossipsub 广播（PoC 示例），生产可替换为 1:1/小群直连 + 群组分层；

- 受限网络与合规策略、备份到 L1 的两种模式等请见英文主文档。

---

## 参考文档

- 英文主文档（完整指南）：`docs/decentralized-chat-on-four-layer-network.md`

- 四层网络部署：`docs/four-layer-network-deployment-and-compute-scheduling.md`

- 受限网络可用性：`docs/restricted-network-availability.md`

- 分布式存储与优化：`docs/intelligent-distributed-storage-and-optimization.md`
