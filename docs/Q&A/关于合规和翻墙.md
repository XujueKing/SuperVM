## 合规前提下的隐私与可用性设计

- 最小化数据暴露
  - 端到端加密与前向保密（E2E + PFS）保护内容机密性；最小化元数据留存（只保必要路由指标、短期化、不可关联化）。
  - 匿名凭证/零知识证明用于“证明权限/状态而不泄露原文”，但在适用的法律框架内使用。

- 分层回退与多路径可用性
  - 四层协同回退：L4 本地签名与排队、L4↔L4 局域协作、L3 区域缓存只读、L2/L1 延迟广播与最终一致。
  - 灰度降级模式：外网受限时切“只读+延迟提交/对账”而非强制失败，恢复后自动补齐。

- 区域化与数据驻留
  - 数据主权分区：L1/L2 依据区域策略进行数据驻留与访问控制；跨境访问需显式授权与审计。
  - L3/L4 尽量本地化计算与缓存，减少跨域传输依赖，提高在受限网络下的可用性。

- 流量整形与抗拥塞（非绕过）
  - 速率整形、突发平滑、拥塞自适应，降低被动丢包/拥塞导致的可用性下降。
  - 协议协商与可插拔传输抽象，用于在允许的网络策略内选择更稳健的传输（而非规避管控）。

- 透明度与合规控制
  - 合规模式开关：地理围栏、可审计日志、数据保留策略、可下发的企业/区域策略。
  - 细粒度访问与最小权限：节点按职能分权，越权访问在本地即被拒绝并记录。

## 针对“墙”的工程抗干扰清单（不涉及规避）

- 可用性
  - Store-and-forward：断连排队、恢复即补传；幂等写保障重复提交安全。
  - 局域协作：同一网络下的 L4↔L4 同步和旁路加速（不出广域网），提升受限环境下的体验。
  - 内容寻址缓存：热门只读数据可从近端 L3/L4 命中，减少跨域依赖。

- 安全与隐私
  - 加密默认开启、密钥轮换、静态数据加密（L2/L3/L4 本地存储）。
  - 元数据最小化与短生命周期指标，避免可关联性积累。

- 运维与监测
  - 健康度探针与阈值：外部可达性下降自动切换降级策略。
  - 合规仪表盘：数据驻留、策略执行、访问路径可视与可审计。

## 可执行的下一步（合规版）

- 在 ROADMAP.md Phase 6 增加“合规与抗干扰”子章节：灰度降级、区域数据驻留、可插拔传输策略、合规模式开关与审计。
- 在 docs 中补充“受限网络下的可用性设计”指南：L4 离线队列/对账、L3 区域只读缓存、恢复后幂等重放。
- 在节点配置中加入 Policy Engine：
  - geo_fencing: on/off
  - compliance_mode: enterprise/regional/global
  - data_retention.days, metadata_minimization: strict/standard
  - fallback_order: [LAN, regional, global]（仅在允许范围内切换）