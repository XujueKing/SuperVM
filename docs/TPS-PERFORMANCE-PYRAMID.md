# SuperVM TPS 性能对比图

```

性能金字塔 (从上到下: 微基准 → 端到端实测 → 生产保守)
═══════════════════════════════════════════════════════════════

                    🏔️ 微基准峰值
                 ╔═══════════════════╗
                 ║  FastPath 30.3M   ║  ← 微基准 (纯内存,零冲突)
                 ╚═══════════════════╝
                        │ 
                        │ 受限于: 冲突率、持久化、锁竞争
                        ↓
                  ╔═══════════════╗
                  ║  MVCC 1.74M   ║  ← 多线程理论 (242K×8×0.9)
                  ╚═══════════════╝
                        │
                        │ 多线程并发批量优化
                        ↓
            ╔═════════════════════════╗
            ║   **1.474M TPS** ✅     ║  ← **端到端最新峰值** (Mode 3, 历史:1.305M)
            ╚═════════════════════════╝
                        │
                        │ 包含组件实测
                        ↓
          ╔═══════════════════════════════╗
          ║  2PC/路由 495K-635K          ║  ← 子系统实测
          ╚═══════════════════════════════╝
                        │
                        │ WAL ON 降级
                        ↓
      ╔═════════════════════════════════════════╗
      ║  生产稳态 600K - 800K TPS (WAL ON)     ║  ← 保守部署
      ╚═════════════════════════════════════════╝

````

## 横向对比: 不同测试维度

```

┌────────────────────────────────────────────────────────────────┐
│                    TPS 测试维度对比                             │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  微基准 (单组件)                                               │
│  ────────────────────────────────────────────────             │
│  FastPath:   ████████████████████████████████  30.3M TPS      │
│  RocksDB:    ████  860K ops/s                                  │
│  MVCC单线程: ██  242K TPS                                      │
│                                                                │
│  端到端 (完整流程)                                             │
│  ────────────────────────────────────────────────             │
│  **多线程并发**: █████████████████  1.474M TPS ✅ **最新峰值** │ (历史 1.305M)
│  4分区路由:  ███  635K TPS                                     │
│  2PC跨分片:  ██  495K TPS                                      │
│  MVCC高竞争: ██  290K TPS                                      │
│                                                                │
│  生产环境 (保守配置)                                           │
│  ────────────────────────────────────────────────             │
│  WAL ON:     ███  600K-800K TPS                                │
│                                                                │
└────────────────────────────────────────────────────────────────┘

图例: █ = 100K TPS

```

---

## 性能瓶颈分析

```

端到端 TPS = min(执行, 提交, 存储)

┌──────────────┬──────────────┬──────────────┐
│  执行引擎    │   提交协调   │   存储层     │
│              │              │              │
│   1.74M      │    1.3M+     │    1.3M+     │
│  (多线程)    │ (流水线优化) │  (内存模式)  │
│              │              │              │
│      ↓       │      ↓       │      ↓       │
│   不是瓶颈   │   已优化 ✅   │   已优化 ✅  │
└──────────────┴──────────────┴──────────────┘
                                    │
                                    ↓
                            实测验证:
                            1. WAL OFF → 1.474M ✅ (历史:1.305M)
                            2. 历史记录 → 1.19M ✅
                            3. WAL ON → 600-800K (预估)

```

---

## 与竞品对比

```

区块链性能对比 (端到端实测 TPS)
═══════════════════════════════════════════════════════

Ethereum      ▏15 TPS
              │
Polygon       ████  7K TPS
              │
BSC           █████  ~10K TPS
              │
Solana        ██████████  ~50K TPS (声称), ~3K TPS (实测)
              │
              │
Sui           ████████████████████  ~297K TPS (实测)
              │
              │
SuperVM       ████████████████████████████████  495K-635K TPS (子系统实测)
(实测)        ███████████████████████████████████████████████████████████████  **1.474M TPS** ✅ **端到端最新峰值** (历史 1.305M)
              │
              │
              0     100K    200K    300K    400K    500K    600K    700K    800K    900K    1M     1.3M

图例:
  ▏ = 10 TPS
  █ = 20K TPS

```

---

## 性能提升路径

```

优化历程: 从单线程到多核并发
═══════════════════════════════════════════

阶段 0: MVCC 基线
  单线程: 242K TPS
  ████████████████████  242K

阶段 1: 多线程并发
  10线程高竞争: 290K TPS  (+20%)
  ████████████████████████  290K

阶段 2: 2PC 并行优化
  跨分片并行读校验: 495K TPS  (+71%)
  ██████████████████████████████████████  495K

阶段 3: 多核路由
  4分区批量时间戳: 635K TPS  (+28%)
  ██████████████████████████████████████████████  635K

阶段 4: 多线程并发批量 ✅ **已实测**
  8线程 Mode 3: 1.474M TPS  (+12.9% vs 1.305M)
  ████████████████████████████████████████████████████████████████████  1.474M ✅ (旧:1.305M)

每个 █ = 20K TPS

```

---

## 性能影响因素

```

┌────────────────────────────────────────────────────┐
│         影响 TPS 的关键因素                        │
├────────────────────────────────────────────────────┤
│                                                    │
│  1. 冲突率                                         │
│     低 (<10%)  ████████████  1.474M ✅ (历史:1.305M) │
│     中 (30%)   ██████  500K                       │
│     高 (80%)   ███  290K ✅ (已实测)              │
│                                                    │
│  2. 对象类型                                       │
│     独占 100%  ████████████████████████  30M+ ✅  │
│     混合 80/20 ██████████████  1.474M ✅ (实测)    │
│     共享 100%  ███  300K-500K                     │
│                                                    │
│  3. 持久化模式                                     │
│     内存       ██████████████  1.474M ✅ (实测)    │
│     WAL OFF    ██████████  860K (RocksDB ops)      │
│     WAL ON     ██████  600K-800K (预估)            │
│                                                    │
│  4. 并发线程                                       │
│     1线程      ██  242K                            │
│     8线程      ██████████████  1.474M ✅ (实测)    │
│     16线程     ███████████████  1.5M+ (估计)      │
│                                                    │
└────────────────────────────────────────────────────┘

█ = 100K TPS (比例不完全准确,仅示意)

```

---

**可视化说明**: 这些图表帮助理解不同测试场景下 TPS 的含义和相互关系。

**重要更新 (2025-11-12)**: ✅ **1.474M TPS 最新峰值已通过端到端实测验证！(历史:1.305M → 1.474M)**

**最新实测结果**:

- concurrent_batch_2pc_bench (100万事务, 8线程, 批量32)

- Mode 3 (多线程并发批量 最新峰值): **1,474,150 TPS** ✅ *(旧:1,305,316)*

- 历史记录 (ROADMAP.md): 1.19M TPS

**关键结论**: 

- 微基准 (30.3M) ≠ 端到端性能

- 端到端实测: **1.474M TPS** (最新峰值) ✅ *(历史:1.305M)*

- 生产环境保守估计: 600K-800K TPS (WAL ON, 持久化)

- 峰值场景: 1.3M+ TPS (WAL OFF, 内存模式)
